<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>도쿄 3박 4일 인터랙티브 여행 플래너</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral -->
    <!-- Application Structure Plan: A tab-based SPA with an 'Overview' dashboard and daily views. The daily view is now a two-column layout on wider screens: the main timeline on the left, and a new 'Checklist & Tips' panel on the right. This increases information density and adds utility (task tracking) without overwhelming the user. Cards are still expandable for deep details. -->
    <!-- Visualization & Content Choices: Overview - Charts retained for a quick summary. Daily Itinerary - Interactive cards with richer content. New 'Checklist' feature (HTML/JS) with checkboxes for interactivity and progress tracking. This directly addresses the feedback for "more information" by making key tasks and tips permanently visible on each day's view. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --base-font-size: 16px;
        }
        html {
            font-size: var(--base-font-size);
        }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .nav-button {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
        }
        .nav-button.active {
            color: #D97706;
            border-bottom-color: #D97706;
        }
        .card {
            background-color: #FFFFFF;
            border-left: 5px solid #FBBF24;
            transition: all 0.3s ease;
        }
        .card-header {
            cursor: pointer;
        }
        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.5s ease-out;
        }
        .card-content.open {
            max-height: 3500px; /* Increased max-height for more content */
            transition: max-height 1.5s ease-in, padding 0.5s ease-in;
        }
        .heat-tip {
            background-color: #EFF6FF;
            border-left-color: #3B82F6;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 280px;
            width: 100%;
            max-width: 400px;
        }
        .checklist-item input[type="checkbox"]:checked + input[type="text"] {
            text-decoration: line-through;
            color: #9CA3AF;
        }
        .checklist-text-input {
            background-color: transparent;
            border: none;
            outline: none;
            width: 100%;
        }
        .checklist-text-input:focus {
            background-color: #FFFBEB;
            border-bottom: 1px solid #FBBF24;
        }
        .shop-detail {
            border-top: 1px solid #F3F4F6;
            padding-top: 0.75rem;
            margin-top: 0.75rem;
        }
        .shop-detail:first-child {
            border-top: none;
            padding-top: 0;
            margin-top: 0;
        }
        .map-link, .copy-button {
            display: inline-block;
            margin-left: 0.5rem;
            text-decoration: none;
            font-size: 1.1rem;
            transition: transform 0.2s ease, color 0.2s ease;
        }
        .map-link:hover, .copy-button:hover {
            transform: scale(1.2);
        }
        .copy-button {
            cursor: pointer;
        }
        .copy-button.copied {
            color: #10B981; /* Green-500 */
        }
        .memo-textarea {
            width: 100%;
            border-radius: 0.5rem;
            border: 1px solid #D1D5DB;
            padding: 0.5rem;
            font-size: 0.875rem;
            margin-top: 0.75rem;
            resize: vertical;
        }
        .toast {
            position: fixed;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: bold;
            transition: bottom 0.5s ease-in-out;
            z-index: 50;
        }
        .toast.show {
            bottom: 2rem;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 320px;
                max-width: 500px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto max-w-6xl p-4 sm:p-6">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-amber-700">도쿄 3박 4일 '쇼핑 & 맛집' 최종 심화 코스</h1>
            <p class="mt-2 text-base md:text-lg text-gray-600">7월의 더위를 피하는 쾌적한 여행 플래너 (2025년 기준 정보)</p>
        </header>

        <nav class="flex justify-center border-b-2 border-gray-200 mb-2">
            <button data-day="0" class="nav-button text-sm sm:text-base font-bold py-3 px-2 sm:px-4">✈️ 개요 & 출국</button>
            <button data-day="1" class="nav-button text-sm sm:text-base font-bold py-3 px-2 sm:px-4">🗓️ 1일차</button>
            <button data-day="2" class="nav-button active text-sm sm:text-base font-bold py-3 px-2 sm:px-4">🗓️ 2일차</button>
            <button data-day="3" class="nav-button text-sm sm:text-base font-bold py-3 px-2 sm:px-4">🗓️ 3일차</button>
            <button data-day="4" class="nav-button text-sm sm:text-base font-bold py-3 px-2 sm:px-4">🗓️ 4일차</button>
        </nav>
        
        <div class="flex justify-center items-center gap-2 mb-6 text-sm flex-wrap">
            <div id="font-controller" class="flex items-center gap-2">
                <span>글자 크기:</span>
                <button id="decrease-font" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-1 px-2 rounded-full">-</button>
                <button id="reset-font" class="bg-gray-200 hover:bg-gray-300 text-gray-800 py-1 px-2 rounded">초기화</button>
                <button id="increase-font" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-1 px-2 rounded-full">+</button>
            </div>
            <div id="data-controller" class="flex items-center gap-2 ml-4">
                <span>계획 관리:</span>
                <button id="save-plan" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded">💾 저장하기</button>
                <button id="delete-plan" class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded">🗑️ 전체 삭제</button>
            </div>
        </div>

        <main id="content-area">
        </main>
        
        <div id="toast-message" class="toast"></div>
    </div>

    <script>
        let tripData = {
            0: {
                title: "여행 개요 및 출국 절차",
                sections: [
                    {
                        title: "✈️ 김포공항 출국 상세 안내",
                        icon: "",
                        items: [
                            { name: "1. 공항 도착 (오전 4:40 ~ 5:10 추천)", content: [{ detail: "국제선 항공편은 최소 2시간 30분 ~ 3시간 전 도착을 권장합니다. 7시 40분 비행기이므로, 오전 5시 전후로 도착하여 여유롭게 준비하는 것이 좋습니다." }] },
                            { name: "2. 항공사 카운터 확인 및 이동", content: [{ detail: "공항에 도착하면 가장 먼저 출국층 중앙에 있는 <b>운항 정보 안내 모니터(FIDS)</b>를 확인하세요.<br>탑승할 항공편명 <b>ANA (NH862)</b>과 목적지(HND)를 찾으면 체크인 카운터 번호(예: A1-A5)를 알 수 있습니다. 김포공항 국제선 ANA 카운터는 보통 <b>2층 A 카운터</b>에 위치하지만, 당일 상황에 따라 변동될 수 있으니 반드시 모니터를 확인하세요." }] },
                            { name: "3. 탑승 수속 및 수하물 처리", content: [{ detail: `
                                <div class="shop-detail">
                                    <p class="font-bold text-gray-800">위탁 수하물 (부치는 짐)</p>
                                    <p class="text-sm mt-1">여권과 E-티켓을 직원에게 보여주고, 큰 캐리어를 저울에 올려 무게를 잽니다. 항공사 규정(일반석 기준 1인당 2개, 각 23kg 이내)을 통과하면 수하물표를 받고 짐을 부칩니다.</p>
                                </div>
                                <div class="shop-detail">
                                    <p class="font-bold text-gray-800">기내 수하물 (들고 타는 짐)</p>
                                    <p class="text-sm mt-1">백팩이나 작은 캐리어 등 기내에 들고 갈 짐은 무게를 재고, 규정에 맞으면 확인용 태그를 붙여줍니다. (일반석 기준 1인당 1개, 10kg 이내)</p>
                                </div>
                                <div class="shop-detail">
                                    <p class="font-bold text-red-600">🚨 기내 수하물이 기준 무게를 넘었을 경우</p>
                                    <p class="text-sm mt-1">
                                        1. 직원이 무게 초과를 알리면, 두 가지 선택지가 있습니다: <b>① 추가 요금 지불</b> 또는 <b>② 짐 일부를 위탁 수하물로 이동</b>.<br>
                                        2. <b>짐을 옮기려면:</b> 잠시 옆으로 비켜나 캐리어를 열고, 무거운 물건(보조배터리 등 기내 반입 필수품 제외)을 위탁 수하물 가방으로 옮겨야 합니다. 다시 줄을 서서 무게를 재거나, 직원의 안내에 따라 처리합니다.<br>
                                        3. <b>요금을 지불하려면:</b> 항공사 규정에 따른 초과 요금을 카운터에서 바로 결제하고 탑승권을 받을 수 있습니다.<br>
                                        <b>팁:</b> 액체류(화장품 등)는 위탁 수하물로 보내고, 보조배터리나 노트북 등 전자기기는 반드시 기내에 들고 타야 합니다.
                                    </p>
                                </div>
                                <div class="shop-detail">
                                    <p class="font-bold text-gray-800">탑승권 수령</p>
                                    <p class="text-sm mt-1">모든 과정이 끝나면 좌석이 배정된 종이 탑승권을 받습니다. 탑승구 번호와 탑승 시작 시간을 꼭 확인하세요.</p>
                                </div>
                            ` }] },
                            { name: "4. 보안 검색 및 출국 심사", content: [{ detail: "탑승권을 받은 후 '출국장' 표지판을 따라 이동합니다. 보안 검색대에서 기내 수하물과 소지품을 검사받고, 이후 출국 심사대에서 여권과 탑승권을 확인받고 통과합니다. (자동출입국심사 등록 시 더욱 빠릅니다.)" }] },
                            { name: "5. 면세 구역 및 탑승구 이동", content: [{ detail: "출국 심사를 마치면 면세 구역입니다. 탑승권에 적힌 <b>탑승구 번호</b>를 다시 확인하고, 비행기 출발 <b>최소 30분 전</b>까지는 해당 탑승구 앞에 도착해야 합니다." }] },
                        ]
                    },
                    {
                        title: "여행 기본 정보",
                        icon: "✈️",
                        items: [
                            { name: "탑승객 정보", content: [{ detail: "<b>서정완 (SUH/JUNGWAN MR)</b> - TKT: 2052815714813<br><b>백지윤 (BAEK/JIYUN MS)</b> - TKT: 2052815714812" }] },
                            { name: "항공편 정보 (예약번호: 5AJLPK)", content: [{ detail: "<b>✈️ 가는편:</b> 7/28(월) 07:40 김포(GMP) Terminal I → 09:50 하네다(HND) (<b>ANA NH862</b>)<br><b>✈️ 오는편:</b> 7/31(목) 20:05 하네다(HND) Terminal 2 → 22:20 김포(GMP) Terminal I (<b>ANA NH867</b>)" }] },
                            { name: "숙소", content: [{ detail: "<b>1일차:</b> Onyado Nono Asakusa Bettei (아사쿠사)<br><b>2-3일차:</b> Nohga Hotel Akihabara Tokyo (아키하바라)" }] },
                        ]
                    },
                ]
            },
            1: {
                title: "아사쿠사 집중 탐방",
                theme: "전통과 현대가 공존하는 아사쿠사의 낮과 밤",
                route_highlight: "하루 종일 아사쿠사 지역에 머물며, 센소지를 중심으로 주변 맛집과 거리를 탐방하고 저녁에는 스카이트리 또는 호피도리로 이동하는 효율적인 동선입니다.",
                checklist: [
                    { text: "사료 츠보시타에서 말차 디저트 먹기", done: false },
                    { text: "키비단고 아즈마에서 당고 맛보기", done: false },
                    { text: "아사쿠사 카게츠도 멜론빵 구매", done: false },
                    { text: "돈키호테 아사쿠사점에서 쇼핑하기", done: false }
                ],
                sections: [
                    {
                        time: "오전 10:00 ~ 11:30",
                        title: "도착 및 준비",
                        items: [{ name: "호텔 짐 보관", icon: "🛄", content: [{ detail: "<b>🚇 이동:</b> 하네다 공항에서 <b>게이큐 공항선(京急空港線)</b> 탑승, 환승 없이 아사쿠사(浅草)역까지 약 40분 소요.<br>Onyado Nono Asakusa Bettei 호텔에 짐 맡기기" }] }]
                    },
                    {
                        time: "오전 11:30 ~ 오후 5:00",
                        title: "아사쿠사 낮 코스: 센소지 주변 탐방",
                        items: [
                            { name: "점심 식사 (선택)", icon: "🍜", content: [
                                { name: { kor: "텐동 텐야", jpn: "てんや", eng: "Tendon Tenya" }, description: "압도적인 가성비의 텐동 체인점", signatureMenu: "기본 텐동, 상(上)텐동", menuDescription: "밥 위에 각종 튀김을 올린 덮밥", avgCostPerPerson: "약 ¥900 / ₩8,100 (기본 텐동 + 미소시루)", rating: "⭐ 3.9", tip: "웨이팅 거의 없음, 빠르고 저렴하게 해결" },
                                { name: { kor: "다이코쿠야 텐푸라", jpn: "大黒家天麩羅", eng: "Daikokuya Tempura" }, description: "참기름으로 튀긴 촉촉한 전통 텐동", signatureMenu: "텐동, 새우 텐동", menuDescription: "진한 간장 소스에 푹 담근 튀김 덮밥", avgCostPerPerson: "약 ¥2,200 / ₩19,800 (텐동 1개 기준)", rating: "⭐ 3.8", tip: "바삭함보다 진한 소스 맛을 즐기는 곳. 식사 시간 웨이팅 김." },
                                { name: { kor: "소메타로", jpn: "染太郎", eng: "Sometaro" }, description: "직접 만들어 먹는 체험형 오코노미야키", signatureMenu: "오코노미야키, 야키소바", menuDescription: "재료를 섞어 철판에 부쳐먹는 일본식 전", avgCostPerPerson: "약 ¥1,600 / ₩14,400 (오코노미야키 1개 + 음료)", rating: "⭐ 4.2", tip: "옛 일본 가옥의 정취를 느낄 수 있음." },
                                { name: { kor: "아사쿠사 우나테츠", jpn: "浅草うな鉄", eng: "Asakusa Unatetsu" }, description: "장어덮밥(히츠마부시) 맛집", signatureMenu: "히츠마부시", menuDescription: "장어덮밥을 세 가지 방식으로 즐기는 요리", avgCostPerPerson: "약 ¥4,000 / ₩36,000", rating: "⭐ 4.3", tip: "점심시간에는 웨이팅이 길 수 있으니 미리 방문 추천." },
                            ]},
                            { name: "전통 디저트 & 간식 투어", icon: "🍡", content: [
                                { name: { kor: "키비단고 아즈마", jpn: "きびだんご あづま", eng: "Kibidango Azuma" }, description: "따끈하고 부드러운 수수 경단", signatureMenu: "키비단고, 말차", menuDescription: "콩고물을 묻힌 작은 수수 경단 꼬치", avgCostPerPerson: "약 ¥400 / ₩3,600 (1인분 기준)", rating: "⭐ 4.4", tip: "나카미세도리 초입에 위치. 회전율이 빠름." },
                                { name: { kor: "아사쿠사 카게츠도", jpn: "浅草花月堂", eng: "Asakusa Kagetsudo" }, description: "얼굴만 한 크기의 거대 멜론빵", signatureMenu: "멜론빵, 아이스 멜론빵", menuDescription: "겉은 바삭, 속은 촉촉한 일본 대표 간식 빵", avgCostPerPerson: "약 ¥300 / ₩2,700 (빵 1개 기준)", rating: "⭐ 4.3", tip: "센소지 본당 근처에 위치." },
                                { name: { kor: "사료 츠보시타", jpn: "茶寮 つぼ市製茶本舗", eng: "Saryo Tsuboichi" }, description: "고급스러운 분위기의 전문 말차 카페", signatureMenu: "말차 파르페, 말차 티라미수", menuDescription: "말차 아이스크림, 팥, 떡 등을 올린 디저트", avgCostPerPerson: "약 ¥1,600 / ₩14,400 (파르페 1개 기준)", rating: "⭐ 4.5", tip: "덴보인도리 근처. 잠시 쉬어가기 좋은 곳." },
                                { name: { kor: "후나와", jpn: "舟和", eng: "Funawa" }, description: "고구마 양갱(이모요캉) 원조 가게", signatureMenu: "이모요캉, 앙코다마", menuDescription: "고구마 본연의 맛이 살아있는 달콤한 양갱", avgCostPerPerson: "약 ¥800 / ₩7,200", rating: "⭐ 4.3", tip: "아사쿠사 기념품으로 가장 유명한 것 중 하나." },
                            ]},
                             { name: "추가 추천 (쇼핑 & 구경)", icon: "✨", content: [
                                { name: { kor: "돈키호테 아사쿠사점", jpn: "ドン・キホーテ 浅草店", eng: "Don Quijote Asakusa" }, description: "없는 게 없는 만물 잡화점", popularItems: "의약품(샤론파스, 카베진), 화장품(퍼펙트휩), 산토리 위스키, 인기 과자류", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.1", tip: "24시간 영업. 늦은 밤이나 이른 아침에 방문하면 여유롭게 쇼핑 가능." },
                                { name: { kor: "푸글렌 아사쿠사", jpn: "フグレン浅草", eng: "Fuglen Asakusa" }, description: "노르웨이 오슬로에서 온 유명 카페", signatureMenu: "오늘의 커피, 에어로프레스 커피", menuDescription: "산미 있는 스페셜티 커피", avgCostPerPerson: "약 ¥800 / ₩7,200", rating: "⭐ 4.4", tip: "낮에는 카페, 밤에는 바로 운영. 감각적인 인테리어." },
                                { name: { kor: "무인양품 (아사쿠사 EKIMISE점)", jpn: "無印良品 浅草EKIMISE", eng: "MUJI Asakusa EKIMISE" }, description: "아사쿠사역과 연결된 쇼핑몰 내 위치", popularItems: "잠옷, 아로마 디퓨저, 레토르트 카레, 문구류", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.0", tip: "동선이 편리하고, 여행 중 필요한 물품을 구매하기 좋음." },
                                { name: { kor: "갓파바시 도구 거리", jpn: "かっぱ橋道具街", eng: "Kappabashi Kitchen Town" }, description: "일본 최대의 주방용품 전문 상점가", popularItems: "일본 식칼, 예쁜 그릇, 음식 모형 열쇠고리", avgCostPerPerson: "구경은 무료", rating: "⭐ 4.3", tip: "요리에 관심 없어도 음식 모형 가게 등 볼거리가 많음." },
                            ]},
                            { name: "주변 산책 및 피서", icon: "🚶‍♂️", type: "heat-tip", content: [{ detail: "<b>산책:</b> 덴보인도리 (伝法院通り / Denboin-dori) → 스미다 공원 강변 산책<br><b>실내 피서:</b> 아사쿠사 문화 관광 센터 8층 무료 전망대, 신나카미세 상점가 (新仲見世商店街 / Shin-Nakamise) 구경<br><b>지하 쇼핑:</b> 아사쿠사역과 연결된 일본에서 가장 오래된 지하상가인 아사쿠사 지하상가 (浅草地下街 / Asakusa Chikagai)에서 레트로한 분위기를 느껴보세요." }] },
                        ]
                    },
                    {
                        time: "오후 5:00 이후",
                        title: "아사쿠사 밤 코스: 야경과 저녁",
                        items: [
                            { name: "호텔 체크인 및 휴식", icon: "♨️", content: [{ detail: "호텔 체크인 후 온천 시설 즐기기" }] },
                            { name: "저녁 & 야경 (선택)", icon: "🌃", content: [
                                { name: { kor: "A코스: 스카이트리", jpn: "東京スカイツリー", eng: "Tokyo Skytree" }, description: "야경, 쇼핑, 식사를 한 번에 해결", signatureMenu: "소라마치 내 다양한 레스토랑", avgCostPerPerson: "식사 약 ¥3,000~ / ₩27,000원~", rating: "⭐ 4.4", tip: "<b>🚇 이동:</b> 아사쿠사역에서 <b>도부 스카이트리 라인(東武スカイツリーライン)</b>으로 1정거장 (약 3분).<br><b>전망대 예약 추천.</b> 공식 홈페이지나 Klook, KKday 등에서 온라인 사전 예매 시 시간 절약 가능. 소라마치 내에 '점프샵'이 있어 만화 굿즈 구경 가능." },
                                { name: { kor: "B코스: 호피도리", jpn: "ホッピー通り", eng: "Hoppy Dori" }, description: "센소지 서쪽에 위치한 활기찬 선술집 거리", signatureMenu: "소 힘줄 조림(규스지니코미), 모츠니코미(곱창조림)", menuDescription: "소 힘줄을 부드럽게 끓여낸 일본식 안주", avgCostPerPerson: "약 ¥3,000 / ₩27,000 (안주 2개 + 주류)", rating: "⭐ 4.1", tip: "저녁 시간엔 매우 붐비지만 빈자리를 찾아 들어가는 재미가 있음." },
                                { name: { kor: "C코스: 몬자야키", jpn: "もんじゃ もへじ", eng: "Monja Moheji" }, description: "아사쿠사 내에 위치한 도쿄 명물 몬자야키 전문점", signatureMenu: "명란 몬자야키, 해물 몬자", menuDescription: "묽은 반죽에 재료를 섞어 철판에 지져 먹는 음식", avgCostPerPerson: "약 ¥2,500 / ₩22,500 (몬자야키 + 음료)", rating: "⭐ 4.7", tip: "직원이 직접 만들어주는 경우가 많아 편리함." },
                            ]},
                             { name: "저녁 산책 코스", icon: "🚶‍♂️", content: [{ detail: "<b>A코스 선택 시:</b> 스카이트리 아래 소라마치 주변 산책<br><b>B코스 선택 시:</b> 조명이 켜진 센소지 경내를 둘러본 후 호피도리로 이동<br><b>C코스 선택 시:</b> 스미다 강변을 따라 걸으며 라이트업된 아사히 맥주 빌딩과 스카이트리 야경 감상" }] },
                        ]
                    }
                ]
            },
            2: {
                title: "우에노 & 아키하바라",
                theme: "활기찬 시장과 서브컬처 성지 순례",
                route_highlight: "아사쿠사에서 체크아웃 후, 가까운 우에노역 코인락커에 짐을 보관하고 오전 일정을 시작합니다. 점심 후 아키하바라로 이동해 호텔 체크인, 이후 아키하바라와 간다 지역을 집중 탐방하는 가장 효율적인 동선입니다.",
                checklist: [
                    { text: "TruffleBAKERY에서 해초버터 소금빵 맛보기", done: false },
                    { text: "아메요코 시장 구경 및 길거리 음식 체험", done: false },
                    { text: "요도바시 카메라에서 소니 SD카드 구매", done: false },
                    { text: "간다 묘진에서 'IT 부적' 구경하기", done: false },
                ],
                sections: [
                    {
                        time: "오전",
                        title: "이동 및 우에노 탐방",
                        items: [
                            { name: "이동 및 짐 보관", icon: "🛄", content: [{ detail: "아사쿠사 호텔 체크아웃 → 호텔에서 도보 약 8분 거리인 <b>도쿄메트로 긴자선(銀座線) 다와라마치역(田原町駅)</b>으로 이동 → <b>긴자선</b> 탑승 후 <b>우에노역(上野駅)</b>으로 이동 (1정거장, 약 2분) → 우에노역 코인락커에 짐 보관" }] },
                            { name: "오전 활동 (우에노)", icon: "🏞️", content: [
                                { name: { kor: "아메요코 시장", jpn: "アメ横", eng: "Ameya Yokocho" }, description: "활기 넘치는 재래시장", signatureMenu: "과일 꼬치, 해산물 덮밥(카이센동)", avgCostPerPerson: "간식 약 ¥500", rating: "⭐ 4.2", tip: "오전 일찍 방문하면 덜 붐빕니다. 저렴한 드럭스토어도 많습니다." },
                                { name: { kor: "★추가추천: 야마시로야", jpn: "ヤマシロヤ", eng: "Yamashiroya" }, description: "우에노역 앞 대형 장난감 가게", popularItems: "캐릭터 상품, 장난감, 프라모델", avgCostPerPerson: "구경은 무료", rating: "⭐ 4.3", tip: "닌텐도, 산리오 등 다양한 캐릭터 상품이 많아 구경하는 재미가 있습니다." },
                                { name: { kor: "★추가추천: 타케야", jpn: "多慶屋", eng: "Takeya" }, description: "보라색 빌딩으로 유명한 종합 할인점", popularItems: "식료품, 의약품, 가전, 명품", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.0", tip: "돈키호테와는 다른 매력의 로컬 할인점. 여러 건물로 나뉘어 있으니 지도를 잘 확인하세요." },
                            ]},
                            { name: "점심 식사 & 디저트 (우에노)", icon: "🥐", content: [
                                { name: { kor: "★요청: 트러플베이커리", jpn: "TruffleBAKERY 上野広小路店", eng: "TruffleBAKERY Ueno" }, description: "해초버터(dulse)를 넣은 '바다소금빵'이 유명한 곳", signatureMenu: "바다소금빵, 트러플소금빵", avgCostPerPerson: "약 ¥1,000 / ₩9,000", rating: "⭐ 4.2", tip: "우에노 마루이에서 도보 5분 거리. 빵 나오는 시간에 맞춰가면 더 맛있습니다." },
                                { name: { kor: "야마베 오카치마치점", jpn: "とんかつ山家 御徒町店", eng: "Tonkatsu Yamabe" }, description: "1000엔 이하 최고의 가성비 돈카츠", signatureMenu: "로스카츠 정식", avgCostPerPerson: "약 ¥950 / ₩8,550", rating: "⭐ 4.5", tip: "식사 시간에는 항상 긴 줄이 있음. 아메요코 시장 근처." },
                                { name: { kor: "미우라미사키코", jpn: "三浦三崎港", eng: "Miuramisakiko" }, description: "큼직한 네타가 특징인 인기 회전초밥", signatureMenu: "참치 뱃살, 성게알 군함", avgCostPerPerson: "약 ¥2,800 / ₩25,200", rating: "⭐ 4.3", tip: "우에노역 근처. 식사 시간 웨이팅 가능성." },
                                { name: { kor: "★추가추천: 쿠로후네테이", jpn: "黒船亭", eng: "Kurofunetei" }, description: "100년 전통의 유명 경양식(요쇼쿠) 레스토랑", signatureMenu: "하야시라이스, 비프 스튜", avgCostPerPerson: "약 ¥3,000 / ₩27,000", rating: "⭐ 4.3", tip: "고급스러운 분위기에서 클래식한 일본 경양식을 맛볼 수 있습니다." },
                                { name: { kor: "★추가추천: 카야바 커피", jpn: "カヤバ珈琲", eng: "Kayaba Coffee" }, description: "오래된 목조 가옥을 개조한 레트로 카페", signatureMenu: "계란 샌드위치, 커피", avgCostPerPerson: "약 ¥1,500 / ₩13,500", rating: "⭐ 4.2", tip: "우에노 공원 너머 야나카 지역에 위치. 산책하며 들르기 좋습니다." },
                            ]},
                        ]
                    },
                    {
                        time: "오후",
                        title: "아키하바라 & 간다 탐방",
                        items: [
                             { name: "호텔 체크인", icon: "🏨", content: [{ detail: "우에노역에서 짐 찾기 → <b>🚇 이동:</b> <b>JR 야마노테선</b>으로 <b>우에노역</b> → <b>아키하바라역(秋葉原駅)</b> 이동 (1정거장, 약 2분) → 아키하바라역 <b>電気街口(Electric Town) 출구</b>로 나와 도보 약 6분 → Nohga Hotel Akihabara Tokyo 체크인" }] },
                             { name: "쇼핑 & 구경 (아키하바라/간다)", icon: "🎮", content: [
                                { name: { kor: "★요청: 요도바시 카메라 아키바", jpn: "ヨドバシカメラ マルチメディアAkiba", eng: "Yodobashi Camera Akiba" }, description: "소니 SD카드를 비롯한 모든 전자제품을 구매할 수 있는 초대형 매장", popularItems: "카메라, SD카드, 게임, 가전제품", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.4", tip: "아키하바라역 바로 앞에 위치. 면세 혜택과 다양한 프로모션을 확인하세요." },
                                { name: { kor: "간다 묘진", jpn: "神田明神", eng: "Kanda Myojin Shrine" }, description: "IT 부적과 애니 콜라보로 유명한 신사", signatureMenu: "IT 정보 안전 수호 부적", avgCostPerPerson: "부적 약 ¥800", rating: "⭐ 4.4", tip: "아키하바라에서 도보 10분 거리. 독특한 기념품을 구매하기 좋음." },
                                { name: { kor: "만다라케 콤플렉스", jpn: "まんだらけコンプレックス", eng: "Mandarake Complex" }, description: "8층 규모의 거대한 중고 서브컬처 샵", popularItems: "희귀 피규어, 절판 만화책, 레트로 게임", avgCostPerPerson: "구경은 무료", rating: "⭐ 4.4", tip: "검은색 빌딩 전체가 매장. 희귀템을 찾는 재미가 있음." },
                                { name: { kor: "★추가추천: 2k540 AKI-OKA ARTISAN", jpn: "ニーケーゴーヨンマル アキオカ アルチザン", eng: "2k540 AKI-OKA ARTISAN" }, description: "철길 아래 만들어진 장인들의 거리", popularItems: "수공예품, 가죽 공방, 디자인 소품", avgCostPerPerson: "구경은 무료", rating: "⭐ 4.2", tip: "아키하바라의 서브컬처 분위기와는 다른, 조용하고 감각적인 공간입니다." },
                                { name: { kor: "★추가추천: 아키하바라 라디오회관", jpn: "秋葉原ラジオ会館", eng: "Akihabara Radio Kaikan" }, description: "피규어, 카드 등 다양한 굿즈샵이 모여있는 빌딩", popularItems: "각종 피규어, 트레이딩 카드, 애니 굿즈", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.3", tip: "아키하바라역 바로 앞에 있어 접근성이 매우 좋습니다." },
                            ]},
                        ]
                    },
                    {
                        time: "저녁",
                        title: "아키하바라의 밤",
                        items: [
                            { name: "저녁 식사 (아키하바라 선택)", icon: "🏮", content: [
                                { name: { kor: "규카츠 이치니산", jpn: "牛カツ壱弐参", eng: "Gyukatsu Ichi Ni San" }, description: "개인 화로에 직접 구워 먹는 규카츠", signatureMenu: "규카츠 정식", avgCostPerPerson: "약 ¥1,800 / ₩16,200", rating: "⭐ 4.4", tip: "식사 시간엔 항상 긴 줄. 오픈 직후나 늦은 오후 방문 추천." },
                                { name: { kor: "큐슈 장가라 라멘", jpn: "九州じゃんがららあめん", eng: "Kyushu Jangara Ramen" }, description: "진한 돈코츠 라멘 전문점", signatureMenu: "본샹 라멘, 카라본 라멘", avgCostPerPerson: "약 ¥1,200 / ₩10,800", rating: "⭐ 4.4", tip: "토핑을 자유롭게 추가 가능. 줄은 빨리 줄어드는 편." },
                                { name: { kor: "톤카츠 아오키", jpn: "とんかつ檍", eng: "Tonkatsu Aoki" }, description: "고급 돼지고기를 사용한 가성비 돈카츠", signatureMenu: "상급 로스카츠 정식", avgCostPerPerson: "약 ¥2,500 / ₩22,500", rating: "⭐ 4.4", tip: "소금에 찍어 먹는 것을 추천. 저녁 시간 웨이팅 가능성." },
                                { name: { kor: "★추가추천: 멘야 무사시 부진", jpn: "麺屋武蔵 武仁", eng: "Menya Musashi Bujin" }, description: "두툼한 고기가 올라간 츠케멘 맛집", signatureMenu: "부진 츠케멘", avgCostPerPerson: "약 ¥1,500 / ₩13,500", rating: "⭐ 4.3", tip: "고기 토핑의 양을 조절할 수 있습니다. 면의 양도 선택 가능." },
                                { name: { kor: "★추가추천: 카레는 마실 것", jpn: "カレーは飲み物。", eng: "Curry is a Drink." }, description: "독특한 이름의 인기 카레 전문점", signatureMenu: "검은 소고기 카레, 붉은 닭고기 카레", avgCostPerPerson: "약 ¥1,200 / ₩10,800", rating: "⭐ 4.2", tip: "무료 토핑을 3가지 선택할 수 있어 푸짐하게 즐길 수 있습니다." },
                            ]},
                            { name: "저녁 산책 코스", icon: "🚶‍♂️", content: [{ detail: "네온사인이 화려한 아키하바라의 밤거리를 산책하거나, 조금 조용한 분위기를 원한다면 호텔 주변의 간다 강변을 따라 걷기" }] },
                        ]
                    }
                ]
            },
            3: {
                title: "긴자 → 도쿄역 → 마루노우치",
                theme: "세련된 쇼핑과 반짝이는 도심 야경",
                route_highlight: "아키하바라에서 출발해 긴자에서 쇼핑과 점심을 즐기고, 도보로 도쿄역으로 이동합니다. 오후에는 캐릭터 스트리트를 구경하고, 저녁에는 마루노우치 야경과 치요다구청 전망대를 즐기는 완벽한 도심 코스입니다.",
                checklist: [
                    { text: "무인양품 긴자점 쇼핑하기", done: false },
                    { text: "아식스 긴자점에서 쇼핑하기", done: false },
                    { text: "치이카와 랜드 방문하기 (정리권 확인!)", done: false },
                    { text: "치요다 구청에서 무료 야경 감상하기", done: false }
                ],
                sections: [
                    {
                        time: "오전",
                        title: "긴자 코스: 플래그십 스토어 & 카페",
                        items: [
                            { name: "이동", icon: "🚇", content: [{ detail: "<b>🚶‍♂️ 이동:</b> Nohga Hotel Akihabara Tokyo에서 도보 약 6분 거리인 <b>JR 아키하바라역(秋葉原駅)</b>으로 이동 → <b>JR 야마노테선(山手線)</b> 탑승 (약 7분) → <b>유라쿠초역(有楽町駅)</b> 하차 후 긴자 방면 출구 이용" }] },
                            { name: "메인 쇼핑", icon: "🛍️", content: [
                                { name: { kor: "★메인 미션: 무인양품 긴자점", jpn: "無印良品 銀座", eng: "MUJI Ginza" }, description: "세계 최대 규모의 무인양품 플래그십 스토어", popularItems: "긴자 한정 상품, 의류, 식품, 가구", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.3", tip: "지하 1층의 'MUJI Diner'에서 식사하거나, 1층 베이커리에서 빵을 맛보는 것도 좋습니다." },
                                { name: { kor: "★메인 미션: 아식스 긴자", jpn: "アシックスランウォークギンザ", eng: "ASICS RUNWALK GINZA" }, description: "3D 발 계측 서비스가 있는 아식스 매장", popularItems: "러닝화, 의류, 액세서리", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.2", tip: "정확한 발 사이즈와 모양을 측정하여 최적의 신발을 추천받을 수 있습니다." },
                                { name: { kor: "★추가추천: 이토야", jpn: "伊東屋", eng: "Itoya" }, description: "100년 역사의 대형 문구 전문점", popularItems: "만년필, 노트, 디자인 문구, 미술용품", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.5", tip: "건물 전체가 문구점으로, 각 층별로 테마가 있어 구경하는 재미가 쏠쏠합니다." },
                                { name: { kor: "★추가추천: 긴자 미츠코시 / 마츠야 긴자", jpn: "銀座三越 / 松屋銀座", eng: "Ginza Mitsukoshi / Matsuya Ginza" }, description: "긴자의 대표적인 백화점", popularItems: "명품, 화장품, 지하 식품관(데파치카)", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.2", tip: "지하 식품관(데파치카)은 꼭 들러보세요. 고급스러운 디저트와 도시락의 천국입니다." },
                            ]},
                             { name: "카페 & 디저트 (긴자)", icon: "☕", content: [
                                { name: { kor: "★추가추천: 카페 드 람브르", jpn: "カフェ・ド・ランブル", eng: "Café de L'Ambre" }, description: "1948년부터 영업한 전설적인 커피 명가", signatureMenu: "숙성 원두 드립 커피", avgCostPerPerson: "약 ¥1,200 / ₩10,800", rating: "⭐ 4.4", tip: "오직 커피만 판매하는 곳. 커피 애호가라면 반드시 들러야 할 성지입니다." },
                                { name: { kor: "★추가추천: 라뒤레", jpn: "ラデュレ", eng: "Ladurée" }, description: "마카롱의 대명사, 파리의 고급 디저트 살롱", signatureMenu: "마카롱, 애프터눈 티 세트", avgCostPerPerson: "약 ¥3,000 / ₩27,000", rating: "⭐ 4.2", tip: "긴자 미츠코시 백화점 내에 위치. 창가 자리에서 긴자 거리를 내려다보며 즐길 수 있습니다." },
                            ]},
                        ]
                    },
                    {
                        time: "점심",
                        title: "긴자 & 도쿄역 주변 점심",
                        items: [
                            { name: "점심 식사 (선택)", icon: "🍜", content: [
                                { name: { kor: "긴자 카가리", jpn: "銀座 篝", eng: "Ginza Kagari" }, description: "미슐랭 가이드에 오른 닭백탕 라멘", signatureMenu: "토리파이탄 소바 (특제)", avgCostPerPerson: "약 ¥1,600 / ₩14,400", rating: "⭐ 4.3", tip: "예약 불가, 1~2시간 웨이팅 각오. 크림수프 같은 진한 국물." },
                                { name: { kor: "긴자 스위스", jpn: "銀座スイス", eng: "Ginza Swiss" }, description: "'카츠카레'를 처음 만든 원조 가게", signatureMenu: "원조 카츠카레", avgCostPerPerson: "약 ¥1,900 / ₩17,100", rating: "⭐ 4.1", tip: "클래식한 경양식집 분위기." },
                                { name: { kor: "★추가추천: 츠지한", jpn: "つじ半", eng: "Tsujihan" }, description: "줄 서서 먹는 보석함 같은 카이센동 맛집", signatureMenu: "제이타쿠동 (카이센동)", avgCostPerPerson: "약 ¥2,000 / ₩18,000", rating: "⭐ 4.5", tip: "니혼바시에 위치. 마지막에 도미 국물을 부어 오차즈케로 즐기는 것이 별미입니다." },
                                { name: { kor: "★추가추천: 로쿠린샤", jpn: "六厘舎", eng: "Rokurinsha" }, description: "도쿄역 라멘 스트리트의 절대 강자", signatureMenu: "츠케멘", avgCostPerPerson: "약 ¥1,300 / ₩11,700", rating: "⭐ 4.3", tip: "항상 긴 줄을 자랑하지만 기다릴 가치가 있는 진한 국물의 츠케멘." },
                            ]},
                        ]
                    },
                    {
                        time: "오후 ~ 저녁",
                        title: "도쿄역, 마루노우치 야경",
                        items: [
                            { name: "캐릭터 쇼핑 & 산책", icon: "💖", content: [
                                { name: { kor: "도쿄 캐릭터 스트리트", jpn: "東京キャラクターストリート", eng: "Tokyo Character Street" }, description: "도쿄역 지하에 위치한 캐릭터 굿즈 천국", popularItems: "치이카와, 포켓몬, 점프샵, 방송국 굿즈", avgCostPerPerson: "쇼핑 비용", rating: "⭐ 4.3", tip: "치이카와 랜드 등 인기샵은 정리권 배부 여부를 미리 확인하세요." },
                                { name: { kor: "★추가추천: 도쿄 오카시 랜드", jpn: "東京おかしランド", eng: "Tokyo Okashi Land" }, description: "유명 과자 브랜드의 안테나 샵", popularItems: "매장에서 직접 만든 과자, 한정판 스낵", avgCostPerPerson: "약 ¥1,000", rating: "⭐ 4.1", tip: "캐릭터 스트리트 바로 옆에 위치. 갓 만든 과자를 맛볼 수 있습니다." },
                            ]},
                            { name: { kor: "★요청: 치요다구청 무료 야경", jpn: "千代田区役所", eng: "Chiyoda City Office" }, icon: "🌃", content: [{ detail: "<b>🚇 이동:</b> 도쿄역에서 <b>도쿄메트로 마루노우치선(丸ノ内線)</b> 오테마치역 환승 → <b>한조몬선(半蔵門線)</b> 구단시타역 하차 (약 15분)<br>10층 전망 휴게실에서 고쿄와 마루노우치 빌딩 숲의 차분하고 고급스러운 야경을 무료로 감상할 수 있습니다." }] },
                            { name: "저녁 식사 (도쿄역/마루노우치)", icon: "🍷", content: [
                                { name: { kor: "오레노 이탈리안", jpn: "俺のイタリアン", eng: "Ore no Italian" }, description: "고급 요리를 저렴하게 즐기는 인기 레스토랑", signatureMenu: "트러플 까르보나라, 티본 스테이크", avgCostPerPerson: "약 ¥4,000 / ₩36,000", rating: "⭐ 4.2", tip: "서서 먹는 컨셉. 예약하거나 일찍 방문 추천." },
                                { name: { kor: "유라쿠초 가도 시타", jpn: "有楽町ガード下", eng: "Yurakucho Gado-shita" }, description: "퇴근길 직장인들의 찐 현지 맛집 거리", signatureMenu: "야키토리(닭꼬치), 모츠야키(곱창구이)", avgCostPerPerson: "약 ¥3,000 / ₩27,000", rating: "⭐ 4.0", tip: "연기 자욱한 좁은 가게에서 즐기는 일본 감성." },
                                { name: { kor: "★추가추천: 마루노우치 하우스", jpn: "丸の内ハウス", eng: "Marunouchi House" }, description: "신마루노우치 빌딩 7층의 레스토랑 & 바 존", signatureMenu: "다양한 레스토랑, 테라스 바", avgCostPerPerson: "약 ¥4,000 / ₩36,000", rating: "⭐ 4.2", tip: "테라스에서 도쿄역 야경을 보며 식사나 칵테일을 즐길 수 있습니다." },
                            ]},
                        ]
                    }
                ]
            },
            4: {
                title: "시부야 & 귀국 준비",
                theme: "트렌드의 중심, 시부야에서 마지막 날 즐기기",
                route_highlight: "호텔에 짐을 맡기고 JR 야마노테선으로 시부야로 이동해 마지막 날을 즐깁니다. 쇼핑과 점심 식사 후 다시 아키하바라로 돌아와 짐을 찾고, 하네다 공항으로 이동하는 편리한 동선입니다.",
                checklist: [
                    { text: "시부야 스크램블 교차로 건너보기", done: false },
                    { text: "닌텐도 스토어/점프샵 방문하기", done: false },
                    { text: "시부야 스카이에서 전망 감상 (선택)", done: false },
                    { text: "공항 면세점에서 선물 구매하기", done: false }
                ],
                sections: [
                    {
                        time: "오전",
                        title: "시부야 탐방",
                        items: [
                            { name: "호텔 체크아웃 및 이동", icon: "🛄", content: [{ detail: "호텔 체크아웃 후 프론트에 짐 맡기기 → <b>🚶‍♂️ 이동:</b> 호텔에서 도보 약 6분 거리인 <b>JR 아키하바라역(秋葉原駅)</b>으로 이동 → <b>JR 야마노테선(山手線)</b> 탑승 (시나가와 방면, 약 30분) → <b>시부야역(渋谷駅)</b> 하차 후 <b>하치코 출구</b> 이용" }] },
                            { name: "오전 활동 (시부야)", icon: "🚶‍♀️", content: [{ detail: "<b>명소:</b> 시부야 스크램블 교차로, 하치코 동상<br><b>쇼핑:</b> 시부야 109, 시부야 PARCO (닌텐도 스토어, 점프샵), 디즈니 스토어 등" }] },
                            { name: "점심 식사 (시부야)", icon: "🍔", content: [
                                { name: { kor: "이치란 라멘", jpn: "一蘭", eng: "Ichiran Ramen" }, description: "독서실 칸막이로 유명한 돈코츠 라멘 체인", signatureMenu: "돈코츠 라멘", avgCostPerPerson: "약 ¥1,500 / ₩13,500", rating: "⭐ 4.4", tip: "항상 줄이 길지만 회전율이 빠른 편. 자신만의 라멘을 커스텀할 수 있습니다." },
                                { name: { kor: "우오베이", jpn: "魚べい", eng: "Uobei" }, description: "태블릿으로 주문하는 100엔 스시 체인", signatureMenu: "각종 100엔 스시", avgCostPerPerson: "약 ¥1,800 / ₩16,200", rating: "⭐ 4.3", tip: "가성비가 매우 좋고, 주문하는 재미가 있습니다. 웨이팅이 길 수 있습니다." },
                                { name: { kor: "규카츠 모토무라", jpn: "牛カツもと村", eng: "Gyukatsu Motomura" }, description: "시부야의 또 다른 유명 규카츠 맛집", signatureMenu: "규카츠 정식", avgCostPerPerson: "약 ¥1,900 / ₩17,100", rating: "⭐ 4.3", tip: "아키하바라의 이치니산과 비교해보는 재미도 있습니다." },
                            ]},
                        ]
                    },
                    {
                        time: "오후 3:30 ~",
                        title: "공항으로 이동 및 출국",
                        items: [
                            { name: "출국 준비", icon: "🎁", content: [{ detail: "<b>🚇 이동:</b> JR 야마노테선으로 <b>시부야역</b> → <b>아키하바라역</b> 이동 (약 30분) → 호텔에서 짐 찾기<br><b>🚇 공항 이동:</b> <b>JR 아키하바라역</b>에서 <b>야마노테선</b> 또는 <b>게이힌토호쿠선</b> 탑승 (시나가와/오후나 방면) → <b>하마마쓰초역(浜松町駅)</b>에서 하차 (약 12분) → 표지판을 따라 <b>도쿄 모노레일(東京モノレール)</b>로 환승 → <b>하네다 공항(羽田空港) 제2터미널</b> 하차 (약 20분 소요).<br>체크인 후 면세점에서 '도쿄 밀크 치즈 팩토리', '뉴욕 퍼펙트 치즈' 등 선물 구매" }] },
                        ]
                    }
                ]
            }
        };

        const contentArea = document.getElementById('content-area');
        const navButtons = document.querySelectorAll('.nav-button');
        let themeChart = null;
        let budgetChart = null;

        function createActionLinks(nameObj) {
            if (!nameObj || !nameObj.jpn) return '';
            const query = encodeURIComponent(nameObj.jpn);
            const mapLink = `<a href="https://www.google.com/maps/search/?api=1&query=${query}" target="_blank" rel="noopener noreferrer" class="map-link" title="구글 지도에서 보기">📍</a>`;
            const copyButton = `<span class="copy-button" data-copy-text="${nameObj.jpn}" title="이름 복사">📋</span>`;
            return mapLink + copyButton;
        }

        function renderOverview() {
            const dayData = tripData[0];
            let html = `<h2 class="text-2xl font-bold mb-4 text-amber-800">${dayData.title}</h2>`;

            dayData.sections.forEach(section => {
                html += `
                    <div class="mb-6">
                        <h3 class="text-xl font-semibold mb-3 flex items-center"><span class="mr-2">${section.icon}</span> ${section.title}</h3>
                        <div class="space-y-3">
                `;
                section.items.forEach(item => {
                    html += `
                        <div class="card p-4 rounded-lg shadow-sm border-l-amber-400">
                            <p class="font-semibold text-gray-800">${item.name}</p>
                            <div class="text-gray-600 text-sm mt-1">${item.content[0].detail}</div>
                        </div>
                    `;
                });
                html += `</div></div>`;
            });
            
            html += `
                <div class="grid md:grid-cols-2 gap-8 mt-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-center">📊 일자별 활동 테마</h3>
                        <div class="chart-container bg-white p-4 rounded-lg shadow-md"><canvas id="themeChart"></canvas></div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-3 text-center">💰 식사 예산 분배 (컨셉)</h3>
                        <div class="chart-container bg-white p-4 rounded-lg shadow-md"><canvas id="budgetChart"></canvas></div>
                    </div>
                </div>
            `;

            contentArea.innerHTML = html;
            renderCharts();
        }
        
        function renderDay(day) {
            if (day === 0) {
                renderOverview();
                return;
            }

            const dayData = tripData[day];
            let html = `<div class="grid lg:grid-cols-3 gap-8">`;
            
            html += `<div class="lg:col-span-2">`;
            html += `<h2 class="text-2xl font-bold mb-1 text-amber-800">${day}일차: ${dayData.title}</h2>`;
            html += `<p class="text-md text-gray-500 mb-6">${dayData.theme}</p>`;
            html += `<div class="space-y-6">`;

            dayData.sections.forEach((section, sectionIndex) => {
                html += `
                    <div>
                        <div class="flex items-center mb-3">
                            <span class="bg-amber-500 text-white text-sm font-bold px-3 py-1 rounded-full">${section.time}</span>
                            <h3 class="text-xl font-semibold ml-3">${section.title}</h3>
                        </div>
                        <div class="space-y-3 pl-4 border-l-2 border-gray-200 ml-5">
                `;
                section.items.forEach((item, itemIndex) => {
                    const isHeatTip = item.type === 'heat-tip';
                    const itemName = typeof item.name === 'object' ? item.name.kor : item.name;
                    const actionLinks = createActionLinks(item.name);
                    const itemSubName = typeof item.name === 'object' ? `<p class="text-xs text-gray-400 mt-1">${item.name.jpn} / ${item.name.eng}</p>` : '';

                    let contentHtml = '';
                    item.content.forEach((detailItem, detailIndex) => {
                        if (detailItem.name) {
                            const detailActionLinks = createActionLinks(detailItem.name);
                            const dataPath = `${day}-${sectionIndex}-${itemIndex}-${detailIndex}`;
                            contentHtml += `
                                <div class="shop-detail">
                                    <div class="flex items-center">
                                        <p class="font-bold text-gray-800">${detailItem.name.kor}</p>
                                        ${detailActionLinks}
                                    </div>
                                    <p class="text-xs text-gray-400">${detailItem.name.jpn} / ${detailItem.name.eng}</p>
                                    <p class="text-sm text-gray-500 italic mt-1">"${detailItem.description}"</p>
                                    <div class="mt-2 text-sm space-y-1">
                                        <p><span class="font-semibold text-amber-700">구글 평점:</span> ${detailItem.rating || '정보 없음'}</p>
                                        <p><span class="font-semibold text-amber-700">대표메뉴/품목:</span> ${detailItem.signatureMenu} ${detailItem.menuDescription ? `<span class="text-gray-500 text-xs">- ${detailItem.menuDescription}</span>` : ''}</p>
                                        ${detailItem.popularItems ? `<p><span class="font-semibold text-amber-700">인기 품목:</span> ${detailItem.popularItems}</p>` : ''}
                                        <p><span class="font-semibold text-amber-700">1인당 예상 비용:</span> ${detailItem.avgCostPerPerson}</p>
                                        <p><span class="font-semibold text-amber-700">꿀팁:</span> ${detailItem.tip}</p>
                                    </div>
                                    <div class="mt-3 space-y-2">
                                        <div class="flex items-center gap-4">
                                            <label class="flex items-center cursor-pointer text-sm">
                                                <input type="checkbox" data-type="wantToGo" data-path="${dataPath}" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" ${detailItem.wantToGo ? 'checked' : ''}>
                                                <span class="ml-2">가고 싶어요</span>
                                            </label>
                                            <label class="flex items-center cursor-pointer text-sm">
                                                <input type="checkbox" data-type="visited" data-path="${dataPath}" class="h-4 w-4 rounded border-gray-300 text-green-600 focus:ring-green-500" ${detailItem.visited ? 'checked' : ''}>
                                                <span class="ml-2">다녀왔어요</span>
                                            </label>
                                        </div>
                                        <textarea class="memo-textarea" data-type="memo" data-path="${dataPath}" placeholder="메모를 입력하세요...">${detailItem.memo || ''}</textarea>
                                    </div>
                                </div>
                            `;
                        } else {
                            contentHtml += `<div class="text-gray-600 text-sm">${detailItem.detail}</div>`;
                        }
                    });

                    html += `
                        <div class="card p-4 rounded-lg shadow-sm ${isHeatTip ? 'heat-tip' : ''}">
                            <div class="card-header flex justify-between items-center">
                                <div>
                                    <div class="flex items-center">
                                        <p class="font-semibold text-gray-800 flex items-center"><span class="mr-3 text-xl">${item.icon}</span> ${itemName}</p>
                                        ${actionLinks}
                                    </div>
                                    ${itemSubName}
                                </div>
                                <span class="text-amber-600 transform transition-transform duration-300">▼</span>
                            </div>
                            <div class="card-content pt-0">
                                <div class="mt-2 border-t pt-2">${contentHtml}</div>
                            </div>
                        </div>
                    `;
                });
                html += `</div></div>`;
            });
            html += `</div></div>`;

            html += `<div class="lg:col-span-1">`;
            html += `<div class="sticky top-6">`;
            html += `<div class="bg-white p-4 rounded-lg shadow-md mb-6">
                        <h3 class="text-lg font-bold mb-3 text-amber-800 flex items-center">✔️ ${day}일차 핵심 미션</h3>
                        <ul class="space-y-2">`;
            dayData.checklist.forEach((item, index) => {
                html += `<li class="checklist-item flex items-center gap-2">
                            <label class="flex items-center cursor-pointer flex-grow">
                                <input type="checkbox" data-day="${day}" data-index="${index}" class="h-4 w-4 rounded border-gray-300 text-amber-600 focus:ring-amber-500" ${item.done ? 'checked' : ''}>
                                <input type="text" value="${item.text}" data-day="${day}" data-index="${index}" class="checklist-text-input ml-2 p-1 w-full text-gray-700">
                            </label>
                            <button data-day="${day}" data-index="${index}" class="delete-mission-btn text-red-400 hover:text-red-600 font-bold text-lg">×</button>
                          </li>`;
            });
            html += `</ul>
                       <div class="mt-4 flex gap-2">
                         <input type="text" id="new-mission-input-${day}" class="w-full border-gray-300 rounded-md shadow-sm focus:border-amber-500 focus:ring-amber-500 sm:text-sm" placeholder="새 미션 추가...">
                         <button data-day="${day}" class="add-mission-btn bg-amber-500 hover:bg-amber-600 text-white font-bold py-1 px-3 rounded-md">추가</button>
                       </div>
                     </div>`;
            html += `<div class="bg-blue-50 p-4 rounded-lg shadow-md border-l-4 border-blue-400">
                        <h3 class="text-lg font-bold mb-2 text-blue-800 flex items-center">💡 ${day}일차 동선 하이라이트</h3>
                        <p class="text-sm text-blue-700">${dayData.route_highlight}</p>
                      </div>`;
            html += `</div></div>`;

            html += `</div>`;
            contentArea.innerHTML = html;
        }

        function renderCharts() {
            if (themeChart) themeChart.destroy();
            if (budgetChart) budgetChart.destroy();

            const themeCtx = document.getElementById('themeChart').getContext('2d');
            themeChart = new Chart(themeCtx, {
                type: 'bar',
                data: {
                    labels: ['1일차: 전통', '2일차: 서브컬처', '3일차: 쇼핑', '4일차: 시장'],
                    datasets: [{
                        label: '주요 활동',
                        data: [100, 100, 100, 100],
                        backgroundColor: ['#FBBF24', '#60A5FA', '#F472B6', '#34D399'],
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { y: { display: false } }
                }
            });

            const budgetCtx = document.getElementById('budgetChart').getContext('2d');
            budgetChart = new Chart(budgetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['가성비 맛집', '특별한 맛집', '디저트/간식'],
                    datasets: [{
                        data: [50, 25, 25],
                        backgroundColor: ['#34D399', '#F472B6', '#FBBF24'],
                        borderColor: '#FDFBF8',
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { callbacks: { label: (c) => `${c.label}: ${c.raw}%` } }
                    }
                }
            });
        }
        
        function showTimedToast(message, duration = 8000) {
            const toast = document.getElementById('toast-message');
            if (!toast) return;
            toast.textContent = message;
            toast.style.backgroundColor = '#2563EB'; // Blue-600
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        function saveData() {
            localStorage.setItem('tokyoTripPlanData', JSON.stringify(tripData));
        }

        function loadData() {
            const savedData = localStorage.getItem('tokyoTripPlanData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                // Merge saved user data into the default tripData structure
                Object.keys(parsedData).forEach(dayKey => {
                    if (tripData[dayKey] && parsedData[dayKey].sections) {
                        parsedData[dayKey].sections.forEach((section, sectionIndex) => {
                            section.items.forEach((item, itemIndex) => {
                                item.content.forEach((detailItem, detailIndex) => {
                                    if (detailItem.name && tripData[dayKey].sections[sectionIndex]?.items[itemIndex]?.content[detailIndex]) {
                                        const target = tripData[dayKey].sections[sectionIndex].items[itemIndex].content[detailIndex];
                                        target.wantToGo = detailItem.wantToGo || false;
                                        target.visited = detailItem.visited || false;
                                        target.memo = detailItem.memo || '';
                                    }
                                });
                            });
                        });
                        if (parsedData[dayKey].checklist) {
                           tripData[dayKey].checklist = parsedData[dayKey].checklist;
                        }
                    }
                });
            }
        }
        
        function applyFontSize(size) {
            document.documentElement.style.setProperty('--base-font-size', `${size}px`);
        }

        function updateFontSize(newSize) {
            localStorage.setItem('tokyoTripFontSize', newSize);
            applyFontSize(newSize);
        }

        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const day = parseInt(button.dataset.day);
                navButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                renderDay(day);
            });
        });
        
        contentArea.addEventListener('click', function(e) {
            const copyButton = e.target.closest('.copy-button');
            if (copyButton) {
                e.stopPropagation();
                const textToCopy = copyButton.dataset.copyText;
                const originalIcon = copyButton.innerHTML;

                const textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);

                copyButton.innerHTML = '✅';
                copyButton.classList.add('copied');
                setTimeout(() => {
                    copyButton.innerHTML = originalIcon;
                    copyButton.classList.remove('copied');
                }, 1500);
                return;
            }

            const deleteBtn = e.target.closest('.delete-mission-btn');
            if (deleteBtn) {
                const day = deleteBtn.dataset.day;
                const index = parseInt(deleteBtn.dataset.index);
                tripData[day].checklist.splice(index, 1);
                saveData();
                renderDay(day);
                return;
            }

            const addBtn = e.target.closest('.add-mission-btn');
            if (addBtn) {
                const day = addBtn.dataset.day;
                const input = document.getElementById(`new-mission-input-${day}`);
                if (input && input.value.trim() !== '') {
                    tripData[day].checklist.push({ text: input.value.trim(), done: false });
                    saveData();
                    renderDay(day);
                }
                return;
            }
            
            const header = e.target.closest('.card-header');
            if (header && !e.target.closest('.map-link')) {
                const content = header.nextElementSibling;
                const arrow = header.querySelector('span.text-amber-600');
                content.classList.toggle('open');
                if (content.classList.contains('open')) {
                    content.style.paddingTop = '0.5rem';
                    arrow.style.transform = 'rotate(180deg)';
                } else {
                    content.style.paddingTop = '0';
                    arrow.style.transform = 'rotate(0deg)';
                }
            }
        });

        contentArea.addEventListener('input', function(e) {
            const target = e.target;
            if (target.matches('input[type="checkbox"][data-path]')) {
                const [day, sectionIndex, itemIndex, detailIndex] = target.dataset.path.split('-');
                const type = target.dataset.type;
                tripData[day].sections[sectionIndex].items[itemIndex].content[detailIndex][type] = target.checked;
                saveData();
            } else if (target.matches('textarea[data-path]')) {
                const [day, sectionIndex, itemIndex, detailIndex] = target.dataset.path.split('-');
                tripData[day].sections[sectionIndex].items[itemIndex].content[detailIndex].memo = target.value;
                saveData();
            } else if (target.matches('input[type="checkbox"][data-day]')) {
                 const day = target.dataset.day;
                 const index = target.dataset.index;
                 tripData[day].checklist[index].done = target.checked;
                 saveData();
            } else if (target.matches('.checklist-text-input')) {
                const day = target.dataset.day;
                const index = target.dataset.index;
                tripData[day].checklist[index].text = target.value;
                saveData();
            }
        });

        // Font size controller logic
        const increaseButton = document.getElementById('increase-font');
        const decreaseButton = document.getElementById('decrease-font');
        const resetButton = document.getElementById('reset-font');
        let currentFontSize = parseInt(localStorage.getItem('tokyoTripFontSize') || '16');
        
        applyFontSize(currentFontSize);

        increaseButton.addEventListener('click', () => {
            if (currentFontSize < 24) { // Max size
                currentFontSize += 1;
                updateFontSize(currentFontSize);
            }
        });

        decreaseButton.addEventListener('click', () => {
            if (currentFontSize > 12) { // Min size
                currentFontSize -= 1;
                updateFontSize(currentFontSize);
            }
        });
        
        resetButton.addEventListener('click', () => {
            currentFontSize = 16; // Default size
            updateFontSize(currentFontSize);
        });

        // Initialize
        loadData();
        
        const initialDay = 2;
        navButtons.forEach(btn => btn.classList.remove('active'));
        const activeButton = document.querySelector(`.nav-button[data-day='${initialDay}']`);
        if(activeButton) {
            activeButton.classList.add('active');
        }

        renderDay(initialDay);
        
    </script>
</body>
</html>
